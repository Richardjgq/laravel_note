# 查询构建器

### 知识点整理

```
1.简介
    查询构造器接口用于创建和执行数据库查询.
    查询构建器使用PDO参数绑定来避免SQL注入攻击,不用过滤了.

2.获取结果集
    # 从一张表中获取所有行
        $users = DB::table('users')->get();
    # 从一张表中获取一行/一列
        $user = DB::table('users')->where('name', 'John')->first();
        $email = DB::table('users')->where('name', 'John')->value('email');
    # 获取数据列值列表
        $titles = DB::table('roles')->pluck('title');
        $roles = DB::table('roles')->pluck('title', 'name');
        foreach ($roles as $name => $title) {
            echo $title;
        }
    # 组块结果集
        DB::table('users')->orderBy('id')->chunk(100, function($users) {
            foreach ($users as $user) {
                //
            }
            // 返回false终止组块的运行
            return false;
        });
    # 聚合函数
        count,max,min,avg,sum
        $users = DB::table('users')->count();
        $price = DB::table('orders')->max('price');
        $price = DB::table('orders')
                ->where('finalized', 1)
                ->avg('price');

3.查询(select)
4.原声表达式
5.连接(join)
6.联合(union)
7.子句(where)
8.排序,分组,限定
9.条件子句
10.插入(insert)
11.更新(update)
12.删除(delete)
13.悲观锁
```

数据库查询构建器提供了一个方便的流接口用于创建和执行数据库查询.查询构建器可以用于执行应用中大部分数据库操作,并且能够在支持的所有数据库系统上工作.

Laravel查询构建器使用PDO参数绑定来避免SQL注入攻击,不再需要过滤传递到绑定的字符串.

