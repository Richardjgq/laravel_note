# 分页

### 知识点整理

```
1.简介
    分页器集成了查询构建器和Eloquent ORM,兼容Bootstrap CSS框架

2.基本使用
    # 基于查询构建器进行分页,使用paginate方法
        public function index()
        {
            $users = DB::table('users')->paginate(15);
            return view('user.index', ['users' => $users]);
        }

    ## 简单分页:简单的显示"下一页"和"上一页"链接
        $users = DB::table('users')->simplePaginate(15);

    # 基于Eloquent结果集进行分页
        $users = App\User::paginate(15);
        $users = User::where('votes', '>', 100)->paginate(15);
        $users = User::where('votes', '>', 100)->simplePaginate(15);

    # 手动创建分页器
        Illuminate\Pagination\Paginator 或 
        Illuminate\Pagination\LengthAwarePaginator 实例
        Paginator对应simplePaginate方法(没有最后一页,只能上一页下一页),而LengthAwarePaginator对应paginate方法.
        注:当手动创建分页器实例的时候,应该手动对传递到分页器的结果集进行"切片".

3.显示分页结果
    调用paginate方法,获取Illuminate\Pagination\LengthAwarePaginator实例
    调用simplePaginate时,将会获取Illuminate\Pagination\Paginator实例
    分页器实例本身就是迭代器,可以像数组一样对其进行循环调用
    <div class="container">
        @foreach ($users as $user)
            {{ $user->name }}
        @endforeach
    </div>

    {{ $users->links() }}
    render方法生成的HTML兼容Bootstrap CSS框架

    # 自定义分页链接
    Route::get('users', function () {
        $users = App\User::paginate(15);
        $users->withPath('custom/url');
        // 生成custom/url?page=N
    });

    # 添加参数到分页链接
    {{ $users->appends(['sort' => 'votes'])->links() }} // &sort=votes
    {{ $users->fragment('foo')->links() }} // 添加”哈希片段”到分页链接
    
    # 将结果转化为JSON
    Illuminate\Contracts\Support\JsonableInterface契约并提供了toJson方法
    
4.自定义分页视图
    调用分页器实例上的links方法时,传递视图名称作为第一个参数.
    {{ $paginator->links('view.name', ['foo' => 'bar']) }}
    也可以命令生成
    php artisan vendor:publish --tag=laravel-pagination
    该命令会将视图放到resources/views/vendor/pagination目录
    
5.分页器实例方法
    $results->count()
    $results->currentPage()
    $results->firstItem()
    $results->hasMorePages()
    $results->lastItem()
    $results->lastPage() (使用simplePaginate 时无效)
    $results->nextPageUrl()
    $results->perPage()
    $results->previousPageUrl()
    $results->total() (使用simplePaginate 时无效)
    $results->url($page)
```



